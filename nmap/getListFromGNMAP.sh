#!/bin/bash

if [ $# -eq 0 ]; then
  echo "getListFromGNMAP.sh [FILE]"
  exit 1
fi

ports=$(cat $1 | grep "open" | cut -d ":" -f3 | tr " " "\n" | grep "open" | cut -d "/" -f1 | sort -nu)

for x in $ports
  do
  data=$(cat $1 | grep " $x/open" | cut -d ' ' -f2)
  if [[ $(echo -e "$data" | wc -c) -ge 2 ]]
    then
    echo -e "\n# $x\n$data"
  fi
done
