#!/bin/bash
# Use arg1 for network/cidr file input eg
#
# 10.10.0.0/24
# 10.10.1.0/23
#

# arp scan each networks
for x in $(cat $1); do
    sudo arp-scan $x | tee -a arp-scan.txt
done
# nmap ping scan
sudo nmap -sn -iL $1 -oG nmap-ping-scan.txt -v
cat nmap-ping-scan.txt | grep 'Up' | sort -u >> nmap-ping-scan-sorted.txt
# Combine results
cat nmap-ping-scan-sorted.txt arp-scan.txt | grep -oE '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}' | sort -u >> full-targets.txt
# run common port nmap scan on discovered hosts
sudo nmap -sS -Pn -oA nmap-common-tcp -iL full-targets.txt